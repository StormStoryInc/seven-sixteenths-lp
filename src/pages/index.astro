---
import BaseHead from '../components/BaseHead.astro';
import Header from '../components/Header.astro';
import Footer from '../components/Footer.astro';
import Hero from '../components/Hero.astro';
import HowItWorks from '../components/HowItWorks.astro';
import Features from '../components/Features.astro';
import CTA from '../components/CTA.astro';
import { SITE_TITLE, SITE_DESCRIPTION } from '../consts';
---

<!doctype html>
<html lang="ja">
	<head>
		<BaseHead title={`${SITE_TITLE} â€” ${SITE_DESCRIPTION}`} description={SITE_DESCRIPTION} />
	</head>
	<body>
		<Header />
		<main>
			<Hero />
			<HowItWorks />
			<Features />
			<CTA />
		</main>
		<Footer />

		<script>
			// Scroll-driven reveal animations
			const observer = new IntersectionObserver(
				(entries) => {
					entries.forEach((entry) => {
						if (entry.isIntersecting) {
							entry.target.classList.add('is-visible');
							observer.unobserve(entry.target);
						}
					});
				},
				{ threshold: 0.15, rootMargin: '0px 0px -40px 0px' }
			);

			document.querySelectorAll('.reveal, .reveal-scale').forEach((el) => {
				observer.observe(el);
			});

			// Smooth header opacity on scroll
			const header = document.querySelector('header');
			if (header) {
				let ticking = false;
				window.addEventListener('scroll', () => {
					if (!ticking) {
						requestAnimationFrame(() => {
							const scrollY = window.scrollY;
							if (scrollY > 100) {
								header.style.borderBottomColor = 'rgba(255, 255, 255, 0.08)';
							} else {
								header.style.borderBottomColor = 'rgba(255, 255, 255, 0.03)';
							}
							ticking = false;
						});
						ticking = true;
					}
				});
			}
		</script>
	</body>
</html>
